Dim swApp As Object
Dim swModel As Object
Dim swAssy As Object
Dim swComp As Object
Dim vComps As Variant
Dim i As Integer
Dim bRet As Boolean

Sub main()
    Set swApp = Application.SldWorks
    Set swModel = swApp.ActiveDoc
    
    If swModel Is Nothing Then
        MsgBox "Lütfen bir montaj dosyası açın.", vbExclamation, "Hata"
        Exit Sub
    End If
    
    ' Doküman tipini kontrol et (2 = Assembly)
    If swModel.GetType <> 2 Then
        MsgBox "Bu makro sadece montaj dosyalarında çalışır.", vbExclamation, "Uyarı"
        Exit Sub
    End If
    
    Set swAssy = swModel
    
    ' Tüm üst düzey bileşenleri al (True = Top Level Only)
    vComps = swAssy.GetComponents(True)
    
    If IsEmpty(vComps) Then
        MsgBox "Montajda bileşen bulunamadı.", vbInformation, "Bilgi"
        Exit Sub
    End If
    
    ' Her bir bileşeni kontrol et ve Float (Sabit değil) yap
    For i = 0 To UBound(vComps)
        Set swComp = vComps(i)
        
        ' Eğer bileşen sabitse (Fixed), Float yap
        If swComp.IsFixed Then
            swComp.IsFixed = False
        End If
    Next i
    
    ' Montajı yeniden oluştur (Rebuild)
    swModel.EditRebuild3
    
    ' Kullanıcıya bilgi ver (İsteğe bağlı, çok sık çalışacaksa kapatılabilir)
    ' MsgBox "Tüm bileşenler serbest (Float) duruma getirildi.", vbInformation, "Tamamlandı"
End Sub
